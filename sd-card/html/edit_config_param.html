<!DOCTYPE html>
<html lang="en" xml:lang="en">
<head>
	<meta charset="UTF-8">
	<title>Configuration</title>

	<style>
		h1 {font-size: 1.8em;}
		h2 {font-size: 1.5em; margin-block-start: 0.0em; margin-block-end: 0.2em;}
		h3 {font-size: 1.2em;}
		h4 {font-size: 1.0em; background-color: lightgray; padding: 5px; margin: 10px 0px 3px 0px;}
		h5 {font-size: 0.83em; margin-top: 0.2em; margin-bottom: 0;}
		p {font-size: 1em;}

		body, html {
			font-size: 100%;
			text-size-adjust: 100%;
			-webkit-text-size-adjust: 100%;
		}

		.table {
			border: 0pt;
			border-collapse: collapse;
			table-layout: fixed;
			width:660px;
			margin-block-start: 10px;
		}

		th {
			vertical-align: middle;
			text-align: left;
			font-size: 1em;
			background-color: lightgray;
			padding: 10px;
		}

		.section {
			padding: 1px 10px 1px 10px;
		}

		td {
			padding: 10px;
			vertical-align: middle;
		}

		.button {
			padding: 5px 10px;
			width: 220px;
			font-size: 1em;
		}

		input[type=number] {
			width: 60px;
			min-width: 60px;
			max-width: 60px;
			margin-right: 10px;
			padding: 3px 5px;
			display: inline-block;
			border: 1px solid #ccc;
			font-size: 1em;
			vertical-align: middle;
		}

		input[type=text], input[type=password] {
			width: 96%;
			min-width:240px;
			max-width:96%;
			margin-right: 10px;
			padding: 3px 5px;
			display: inline-block;
			border: 1px solid #ccc;
			font-size: 1em;
			vertical-align: middle;
		}

		select {
			min-width: 72px;
			max-width: 100%;
			padding: 3px 5px;
			display: inline-block;
			border: 1px solid #ccc;
			font-size: 1em;
			margin-right: 10px;
			vertical-align: middle;
		}

		.select_large {
			width: 100%;
			min-width: 250px;
			max-width: 100%;
			padding: 3px 5px;
			display: inline-block;
			border: 1px solid #ccc;
			font-size: 1em;
			margin-right: 10px;
			vertical-align: middle;
		}

		textarea {
			font-size: 14px;
		}

		.description {
			color: black;
			font-size: 80%;
		}

		.disabled {
			color:rgb(122, 122, 122);
		}

		.invalid-input {
			background-color: #FFAA00;
		}

		input:out-of-range {
			background-color: rgba(255, 0, 0, 0.25);
			border: 1px solid red;
		}

		input:invalid {
			background-color: rgba(255, 0, 0, 0.25);
			border: 1px solid red;
		}

		select:invalid {
			background-color: rgba(255, 0, 0, 0.25);
			border: 1px solid red;
		}

		.hidden {
			display: none;
		}

		.expert {
			background-color: #ffefefb9;
			font-size: 1em;
		}

		.indent1 {
			padding-left: 25px;
			font-size: 1em;
		}

		.indent2 {
			padding-left: 50px;
			font-size: 1em;
		}

		.tooltip {
			position: relative;
			display: inline-block;
		}

		.tooltip .tooltiptext {
			visibility: hidden;
			min-width: 600px;
			max-width: 600px;
			width: 600px;
			background-color: #f1f1f1;

			padding-top: 5px;
			padding-bottom: 10px;
			padding-left: 10px;
			padding-right: 10px;

			border: solid black 1px;

			/* Position the tooltip */
			position: absolute;
			z-index: 99;
			top: 100%;
			left: 100%;
			margin-left: -620px;
		}

		.tooltip:hover .tooltiptext {
			visibility: visible;
		}

		.tooltip .tooltiptext table {
			border-collapse: collapse;
		}

		.tooltip .tooltiptext table th, .tooltip .tooltiptext table td {
			border: 1px solid darkgray;
			padding: 5px;
		}

		.tooltip .tooltiptext h1 { /* Tooltip headline, e.g. parameter name */
			font-size: 1.5em;
			margin-top: 0.2em !important;
			margin-bottom: 0.3em !important;
		}

		.tooltip .tooltiptext h2 { /* Tooltip sub-headline, e.g. description*/
			font-size: 1.2em;
			margin-top: 1em !important;
			margin-bottom: 0.3em !important;
		}

		.tooltip .tooltiptext h3 {
			font-size: 1.05em;
			margin-top: 1em !important;
			margin-bottom: 0.3em !important;
		}

		.tooltip .tooltiptext h4 {
			font-size: 0.83em;
			margin-top: 1em !important;
			margin-bottom: 0.3em !important;
		}

		.tooltip .tooltiptext p {
			margin-top: 0.3em !important;
			margin-bottom: 0.3em !important;
		}

		.tooltip-content {
			width: calc(100% - 2px);
			height: calc(100% - 2px);
			padding: 1px;
		}

		details {
			text-align: justify;
			font-size: 1em;
			margin-right: 10px;
		}

		.field-icon {
			float: right;
			margin-left: -22px;
			margin-top: -22px;
			position: relative;
			z-index: 2;
		}

	</style>

	<link rel="stylesheet" href="mkdocs_theme.css?v=$COMMIT_HASH">
	<link rel="stylesheet" href="mkdocs_theme_extra.css?v=$COMMIT_HASH">
    <script src="jquery-3.6.0.min.js?v=$COMMIT_HASH"></script>
    <link href="firework.css?v=$COMMIT_HASH" rel="stylesheet">
    <script src="firework.js?v=$COMMIT_HASH"></script>
</head>

<body style="font-family: arial; padding: 0px 10px; width:660px; max-width:660px;">
	<h2>Configuration</h2>

	<details id="desc_details">
        <summary><b>CLICK HERE</b> for usage description
        </summary>
		<p>
			This page lists all configuration parameters of the device.
			The description of each parameter can be shown by hovering over or by clicking the
			<img src="help.png" width="14" alt="help"> icon. Parameter which most of the time should kept
			at default setting or parameter which are used for any special purpose, e.g. debugging, are
			marked with <span class="expert">light red background color</span>.
		</p>
		<p>
			Parameter which are not used are hidden and are only shown if functionality is enabled.
		</p>
		<p>
			Don't forget to save the changes with the button <b>"Save And Apply"</b> at the bottom of this page.
            The new configuration gets automatically applied. No reboot is required.
		</p>
    </details>
    <hr>

<div id="divloading">Loading configuration ...</div>
<div id="divcontent" style="display:none">

		<!-- Operation Mode -->
		<table class="table">
			<colgroup>
				<col span="1" style="width:310px">
				<col span="1" style="width:310px;">
				<col span="1">
			</colgroup>

			<tr>
				<th colspan="3">Operation Mode</th>
			</tr>

			<tr>
				<td class="indent1">
					<span>Operation Mode</span>
				</td>
				<td>
					<form id="operationmode_opmode_form">
						<select class="classvisibility_init" name="operationmode.opmode" id="operationmode_opmode_value"
						onchange='setClassVisibility("classvisibility_operationmode_opmode_auto", this.value == 1);
								setClassVisibility("classvisibility_operationmode_opmode_demoimages", this.value >= 0);
					  			gatherChangedParameter(this.form, true)'>
							<option value="-1" selected>Setup</option>
							<option value="0">Manual</option>
							<option value="1">Automatic</option>
						</select>
					</form>
				</td>
				<td style="visibility:hidden">$TOOLTIP_operationmode_opmode</td>
			</tr>

			<tr class="classvisibility_operationmode_opmode_auto">
				<td class="indent2">
					<span>Automatic Process Interval</span>
				</td>
				<td>
					<form id="operationmode_automaticprocessinterval_form">
						<input required type="number" min="0.1" step="0.1" value="1.0"
							name="operationmode.automaticprocessinterval" id="operationmode_automaticprocessinterval_value"
							onchange="(!validity.rangeUnderflow||(value=0.1)) && (!validity.stepMismatch||(value=this.value));
								gatherChangedParameter(this.form)">Minutes
					</form>
				</td>
				<td style="visibility:hidden">$TOOLTIP_operationmode_automaticprocessinterval</td>
			</tr>

			<tr class="classvisibility_operationmode_opmode_demoimages expert">
				<td class="indent1">
					<span>Use Demo Images</span>
				</td>
				<td>
					<form id="operationmode_usedemoimages_form">
						<select name="operationmode.usedemoimages" id="operationmode_usedemoimages_value"
								onchange="gatherChangedParameter(this.form)">
							<option value="false" selected>Disabled</option>
							<option value="true">Enabled</option>
						</select>
					</form>
				</td>
				<td style="visibility:hidden">$TOOLTIP_operationmode_usedemoimages</td>
			</tr>

		</table>

	<!-- Take Image -->
	<table class="table">
		<colgroup>
			<col span="1" style="width:310px">
			<col span="1" style="width:310px;">
			<col span="1">
		</colgroup>

		<tr>
			<th colspan="3">Take Image</th>
		</tr>

		<tr>
			<td style="padding-top:25px" colspan="3">
				<b>Flashlight</b>
			</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Flashlight GPIO Mapping</span>
			</td>
			<td>
				<span id="takeimage_flashlightgpiomapping_value"></span>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_flashlight_gpiomapping</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Flash Time</span>
			</td>
			<td>
				<form id="takeimage_flashlight_flashtime_form">
					<input required type="number" min="100" step="100" value="2000"
						name="takeimage.flashlight.flashtime" id="takeimage_flashlight_flashtime_value"
						onchange="(!validity.rangeUnderflow||(value=100)) && (!validity.stepMismatch||(value=this.value));
							gatherChangedParameter(this.form, true)">Milliseconds
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_flashlight_flashtime</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Flash Intensity</span>
			</td>
			<td>
				<form id="takeimage_flashlight_flashintensity_form">
					<input required type="number" min="0" max="100" value="50"
						name="takeimage.flashlight.flashintensity" id="takeimage_flashlight_flashintensity_value"
						onchange="(!validity.rangeUnderflow||(value=0)) && (!validity.rangeOverflow||(value=100));
							gatherChangedParameter(this.form, true)">%
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_flashlight_flashintensity</td>
		</tr>

		<tr>
			<td style="padding-top:25px" colspan="3">
				<b>Camera</b>
			</td>
		</tr>

		<tr class="expert">
			<td class="indent1">
				<span>Camera Frequency</span>
			</td>
			<td>
				<form id="takeimage_camera_camerafrequency_form">
					<select name="takeimage.camera.camerafrequency" id="takeimage_camera_camerafrequency_value"
							onchange="gatherChangedParameter(this.form, true)">
						<option value="20" selected>20 Mhz</option>
						<option value="10" >10 Mhz</option>
						<option value="8" >8 Mhz</option>
						<option value="5" >5 Mhz</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_camera_camerafrequency</td>
		</tr>

		<tr class="expert">
			<td class="indent1">
				<span>Image Quality</span>
			</td>
			<td>
				<form id="takeimage_camera_imagequality_form">
					<input required type="number" min="8" max="63" value="12"
						name="takeimage.camera.imagequality" id="takeimage_camera_imagequality_value"
						onchange="(!validity.rangeUnderflow||(value=8)) && (!validity.rangeOverflow||(value=63));
							gatherChangedParameter(this.form, true)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_camera_imagequality</td>
		</tr>

		<tr class="expert">
			<td class="indent1">
				<span>Image Size</span>
			</td>
			<td>
				<form id="takeimage_camera_imagesize_form">
					<select name="takeimage.camera.imagesize" id="takeimage_camera_imagesize_value"
							onchange="gatherChangedParameter(this.form)">
						<option value="VGA" selected>VGA</option>
						<option value="QVGA" >QVGA</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_camera_imagesize</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Brightness</span>
			</td>
			<td>
				<form id="takeimage_camera_brightness_form">
					<input required type="number" min="-2" max="2" value="0"
						name="takeimage.camera.brightness" id="takeimage_camera_brightness_value"
						onchange="(!validity.rangeUnderflow||(value=-2)) && (!validity.rangeOverflow||(value=2));
							gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_camera_brightness</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Contrast</span>
			</td>
			<td>
				<form id="takeimage_camera_contrast_form">
					<input required type="number" min="-2" max="2" value="0"
						name="takeimage.camera.contrast" id="takeimage_camera_contrast_value"
						onchange="(!validity.rangeUnderflow||(value=-2)) && (!validity.rangeOverflow||(value=2));
							gatherChangedParameter(this.form, true)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_camera_contrast</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Saturation</span>
			</td>
			<td>
				<form id="takeimage_camera_saturation_form">
					<input required type="number" min="-2" max="2" value="0"
						name="takeimage.camera.saturation" id="takeimage_camera_saturation_value"
						onchange="(!validity.rangeUnderflow||(value=-2)) && (!validity.rangeOverflow||(value=2));
							gatherChangedParameter(this.form, true)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_camera_saturation</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Sharpness</span>
			</td>
			<td>
				<form id="takeimage_camera_sharpness_form">
					<select name="takeimage.camera.sharpness" id="takeimage_camera_sharpness_value"
							onchange="gatherChangedParameter(this.form, true)">
						<option value="-4">Auto</option>
						<option value="-3">-3</option>
						<option value="-2">-2</option>
						<option value="-1">-1</option>
						<option value="0" selected> 0</option>
						<option value="1"> 1</option>
						<option value="2"> 2</option>
						<option value="3"> 3</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_camera_sharpness</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Exposure Control Mode</span>
			</td>
			<td>
				<form id="takeimage_camera_exposurecontrolmode_form">
					<select class="classvisibility_init" name="takeimage.camera.exposurecontrolmode" id="takeimage_camera_exposurecontrolmode_value"
							onchange='setClassVisibility("classvisibility_takeimage_exposurecontrolmode_auto", this.value > 0);
									  	setClassVisibility("classvisibility_takeimage_exposurecontrolmode_manual", this.value == 0);
										gatherChangedParameter(this.form, true)'>
						<option value="0">Manual</option>
						<option value="1" selected>Auto</option>
						<option value="2">Auto (AEC2)</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_camera_exposurecontrolmode</td>
		</tr>

		<tr class="classvisibility_takeimage_exposurecontrolmode_auto">
			<td class="indent2">
				<span>Auto Exposure Level</span>
			</td>
			<td>
				<form id="takeimage_camera_autoexposurelevel_form">
					<input required type="number" min="-2" max="2" value="0"
						name="takeimage.camera.autoexposurelevel" id="takeimage_camera_autoexposurelevel_value"
						onchange="(!validity.rangeUnderflow||(value=-2)) && (!validity.rangeOverflow||(value=2));
							gatherChangedParameter(this.form, true)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_camera_autoexposurelevel</td>
		</tr>

		<tr class="classvisibility_takeimage_exposurecontrolmode_manual">
			<td class="indent2">
				<span>Manual Exposure Value</span>
			</td>
			<td>
				<form id="takeimage_camera_manualexposurevalue_form">
					<input required type="number" min="0" max="1200" value="300"
						name="takeimage.camera.manualexposurevalue" id="takeimage_camera_manualexposurevalue_value"
						onchange="(!validity.rangeUnderflow||(value=0)) && (!validity.rangeOverflow||(value=1200));
							gatherChangedParameter(this.form, true)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_camera_manualexposurevalue</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Gain Control Mode</span>
			</td>
			<td>
				<form id="takeimage_camera_gaincontrolmode_form">
					<select class="classvisibility_init" name="takeimage.camera.gaincontrolmode" id="takeimage_camera_gaincontrolmode_value"
							onchange="setClassVisibility('classvisibility_takeimage_gaincontrolmode_manual', this.value == 0);
										gatherChangedParameter(this.form, true)">
						<option value="0">Manual</option>
						<option value="1" selected>Auto</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_camera_gaincontrolmode</td>
		</tr>

		<tr class="classvisibility_takeimage_gaincontrolmode_manual">
			<td class="indent1">
				<span>Manual Gain Value</span>
			</td>
			<td>
				<form id="takeimage_camera_manualgainvalue_form">
					<input required type="number" min="0" max="5" value="0"
						name="takeimage.camera.manualgainvalue" id="takeimage_camera_manualgainvalue_value"
						onchange="(!validity.rangeUnderflow||(value=0)) && (!validity.rangeOverflow||(value=5));
							gatherChangedParameter(this.form, true)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_camera_manualgainvalue</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Special Effect</span>
			</td>
			<td>
				<form id="takeimage_camera_specialeffect_form">
					<select name="takeimage.camera.specialeffect" id="takeimage_camera_specialeffect_value"
							onchange="gatherChangedParameter(this.form, true)">
						<option value="0" selected>None</option>
						<option value="1">Negative</option>
						<option value="2">Grayscale</option>
						<option value="7">Gray+Negative</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_camera_specialeffect</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Mirror Image</span>
			</td>
			<td>
				<form id="takeimage_camera_mirrorimage_form">
					<select name="takeimage.camera.mirrorimage" id="takeimage_camera_mirrorimage_value"
							onchange="gatherChangedParameter(this.form)">
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_camera_mirrorimage</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Flip Image</span>
			</td>
			<td>
				<form id="takeimage_camera_flipimage_form">
					<select name="takeimage.camera.flipimage" id="takeimage_camera_flipimage_value"
							onchange="gatherChangedParameter(this.form)">
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_camera_flipimage</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Zoom Mode</span>
			</td>
			<td>
				<form id="takeimage_camera_zoommode_form">
					<select class="classvisibility_init" name="takeimage.camera.zoommode" id="takeimage_camera_zoommode_value"
							onchange='setClassVisibility("classvisibility_takeimage_zoommode", this.value > 0);
								gatherChangedParameter(this.form, true)'>
						<option value="0" selected>Off</option>
						<option value="1">Crop</option>
						<option value="2">Scale & Crop</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_camera_zoommode</td>
		</tr>

		<tr class="classvisibility_takeimage_zoommode">

			<td class="indent2">
				<span>Zoom Offset X</span>
			</td>
			<td>
				<form id="takeimage_camera_zoomoffsetx_form">
					<input required type="number" min="0" max="960" value="0"
						name="takeimage.camera.zoomoffsetx" id="takeimage_camera_zoomoffsetx_value"
						onchange="(!validity.rangeUnderflow||(value=0)) && (!validity.rangeOverflow||(value=960));
							gatherChangedParameter(this.form, true)">Pixel
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_camera_zoomoffsetx</td>
		</tr>

		<tr class="classvisibility_takeimage_zoommode">

			<td class="indent2">
				<span>Zoom Offset Y</span>
			</td>
			<td>
				<form id="takeimage_camera_zoomoffsety_form">
					<input required type="number" min="0" max="720" value="0"
						name="takeimage.camera.zoomoffsety" id="takeimage_camera_zoomoffsety_value"
						onchange="(!validity.rangeUnderflow||(value=0)) && (!validity.rangeOverflow||(value=720));
							gatherChangedParameter(this.form, true)">Pixel
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_camera_zoomoffsety</td>
		</tr>

		<tr>
			<td style="padding-top:25px" colspan="3">
				<b>Debug</b>
			</td>
		</tr>

		<tr class="expert">
			<td class="indent1">
				<span>Save Raw Images</span>
			</td>
			<td>
				<form id="takeimage_debug_saverawimages_form">
					<select class="classvisibility_init" name="takeimage.debug.saverawimages" id="takeimage_debug_saverawimages_value"
							onchange='setClassVisibility("classvisibility_takeimage_debug_saverawimages", this.value);
										gatherChangedParameter(this.form)'>
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_debug_saverawimages</td>
		</tr>

		<tr class="classvisibility_takeimage_debug_saverawimages expert">
			<td class="indent2">
				<span>Raw Images Location</span>
			</td>
			<td>
				<form id="takeimage_debug_rawimageslocation_form">
					<input required type="text"
						name="takeimage.debug.rawimageslocation" id="takeimage_debug_rawimageslocation_value"
						onchange="gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_debug_rawimageslocation</td>
		</tr>

		<tr class="classvisibility_takeimage_debug_saverawimages expert">
			<td class="indent2">
				<span>Raw Images Retention</span>
			</td>
			<td>
				<form id="takeimage_debug_rawimagesretention_form">
					<input required type="number" min="0" value="5"
						name="takeimage.debug.rawimagesretention" id="takeimage_debug_rawimagesretention_value" placeholder="/log/source"
						onchange="(!validity.rangeUnderflow||(value=0));gatherChangedParameter(this.form, true)">Days
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_takeimage_debug_rawimagesretention</td>
		</tr>

	</table>


	<!-- Image Alignment -->
	<table class="table">
		<colgroup>
			<col span="1" style="width:310px">
			<col span="1" style="width:310px;">
			<col span="1">
		</colgroup>

		<tr>
			<th colspan="3">Image Alignment</th>
		</tr>

		<tr>
			<td class="indent1">
				<span>Alignment Algorithm</span>
			</td>
			<td>
				<form id="imagealignment_alignmentalgo_form">
					<select class="classvisibility_init" name="imagealignment.alignmentalgo" id="imagealignment_alignmentalgo_value"
							onchange="setClassVisibility('classvisibility_imagealignment_algo_3', this.value < 3);
									  setClassVisibility('classvisibility_imagealignment_algo_4', this.value < 4);
								gatherChangedParameter(this.form, true)">
						<option value="0" selected>Rotation + Default Algo</option>
						<option value="1" >Rotation + High Accuracy Algo</option>
						<option value="2" >Rotation + Fast Algo</option>
						<option value="3" >Only Rotation</option>
						<option value="4" >Off</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_imagealignment_alignmentalgo</td>
		</tr>

		<tr class="classvisibility_imagealignment_algo_3 expert">
			<td class="indent2">
			    <span>Search Field X</span>
			</td>
			<td>
				<form id="imagealignment_searchfield_x_form">
					<input required type="number" min="1" value="20"
						name="imagealignment.searchfield.x" id="imagealignment_searchfield_x_value"
						onchange="(!validity.rangeUnderflow||(value=1));gatherChangedParameter(this.form, true)">Pixel
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_imagealignment_searchfield_x</td>
		</tr>

		<tr class="classvisibility_imagealignment_algo_3 expert">
			<td class="indent2">
				<span>Search Field Y</span>
			</td>
			<td>
				<form id="imagealignment_searchfield_y_form">
					<input required type="number" min="1" value="20"
						name="imagealignment.searchfield.y" id="imagealignment_searchfield_y_value"
						onchange="(!validity.rangeUnderflow||(value=1));gatherChangedParameter(this.form, true)">Pixel
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_imagealignment_searchfield_y</td>
		</tr>

		<tr class="classvisibility_imagealignment_algo_3 classvisibility_imagealignment_algo_4">
			<td class="indent1">
			    <span>Image Rotation</span>
			</td>
			<td>
				<form id="imagealignment_imagerotation_form">
					<input required type="number" min="-180.0" max="180.0" step="0.1" value="0.0"
						name="imagealignment.imagerotation" id="imagealignment_imagerotation_value"
						onchange="(!validity.rangeUnderflow||(value=-180.0)) && (!validity.rangeOverflow||(value=180.0)) &&
							(!validity.stepMismatch||(value=this.value));gatherChangedParameter(this.form)">Degree
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_imagealignment_imagerotation</td>
		</tr>

		<tr>
			<td class="indent1">
			    <span>Flip Image Size</span>
			</td>
			<td>
				<form id="imagealignment_flipimagesize_form">
					<select name="imagealignment.flipimagesize" id="imagealignment_flipimagesize_value"
							onchange="gatherChangedParameter(this.form)">
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_imagealignment_flipimagesize</td>
		</tr>

		<tr>
			<td style="padding-top:25px" colspan="3">
				<b>Debug</b>
			</td>
		</tr>

		<tr class="expert">
			<td class="indent1">
			    <span>Save Debug Info</span>
			</td>
			<td>
				<form id="imagealignment_debug_savedebuginfo_form">
					<select name="imagealignment.debug.savedebuginfo" id="imagealignment_debug_savedebuginfo_value"
							onchange="gatherChangedParameter(this.form)">
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_imagealignment_debug_savedebuginfo</td>
		</tr>
	</table>


	<!-- Digit ROIs -->
	<table class="table">
		<colgroup>
			<col span="1" style="width:310px">
			<col span="1" style="width:310px;">
			<col span="1">
		</colgroup>

		<tr>
			<th>
				<span>Digit ROI Processing</span>
			</th>
			<th class="section">
				<form id="digit_enabled_form">
					<select style="font-weight:bold" class="classvisibility_init" name="digit.enabled" id="digit_enabled_value"
							onchange="setClassVisibility('classvisibility_digit_enabled', this.value); $(digit_model_value).trigger('onchange')
								this.value == 'true' ? $(digit_debug_saveroiimages_value).trigger('onchange') : null;
								gatherChangedParameter(this.form)">
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</th>
			<th hidden>$TOOLTIP_digit_enabled</th>
		</tr>

		<tr class="classvisibility_digit_enabled">
			<td class="indent1" >
				<span>Model</span>
			</td>
			<td>
				<form id="digit_model_form">
					<select class="select_large" name="digit.model" id="digit_model_value"
						onchange="setClassVisibility('classvisibility_digit_model_class11',
														$(digit_enabled_value).val() && this.value.includes('class11'));
							setClassVisibility('classvisibility_digit_model_cont',
														$(digit_enabled_value).val() && this.value.includes('cont'));
							gatherChangedParameter(this.form)">
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_digit_model</td>
		</tr>

		<tr class="classvisibility_digit_enabled classvisibility_digit_model_cont expert">
			<td class="indent1">
				<span>CNN Good Threshold</span>
			</td>
			<td>
				<form id="digit_cnngoodthreshold_form">
					<input required type="number" min="0" max="1" step="0.01" value="0.00"
						name="digit.cnngoodthreshold" id="digit_cnngoodthreshold_value"
						onchange="(!validity.rangeUnderflow||(value=0)) && (!validity.rangeOverflow||(value=1)) &&
							(!validity.stepMismatch||(value=this.value));gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_digit_cnngoodthreshold</td>
		</tr>

		<tr class="classvisibility_digit_enabled">
			<td style="padding-top:25px" colspan="3">
				<b>Debug</b>
			</td>
		</tr>

		<tr class="classvisibility_digit_enabled expert">
			<td class="indent1">
				<span>Save ROI Images</span>
			</td>
			<td>
				<form id="digit_debug_saveroiimages_form">
					<select name="digit.debug.saveroiimages" id="digit_debug_saveroiimages_value"
							onchange='setClassVisibility("classvisibility_digit_debug_saveroiimages", this.value);
								gatherChangedParameter(this.form)'>
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_digit_debug_saveroiimages</td>
		</tr>

		<tr class="classvisibility_digit_enabled classvisibility_digit_debug_saveroiimages expert">
			<td class="indent2">
				<span>ROI Images Location</span>
			</td>
			<td>
				<form id="digit_debug_roiimageslocation_form">
					<input required type="text"
						name="digit.debug.roiimageslocation" id="digit_debug_roiimageslocation_value"
						onchange="gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_digit_debug_roiimageslocation</td>
		</tr>

		<tr class="classvisibility_digit_enabled classvisibility_digit_debug_saveroiimages expert">
			<td class="indent2">
				<span>ROI Images Retention</span>
			</td>
			<td>
				<form id="digit_debug_roiimagesretention_form">
					<input required type="number" min="0" value="5"
						name="digit.debug.roiimagesretention" id="digit_debug_roiimagesretention_value" placeholder="/log/digit"
						onchange="(!validity.rangeUnderflow||(value=0));gatherChangedParameter(this.form, true)">Days
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_digit_debug_roiimagesretention</td>
		</tr>
	</table>


	<!-- Analog ROIs -->
	<table class="table">
		<colgroup>
			<col span="1" style="width:310px">
			<col span="1" style="width:310px;">
			<col span="1">
		</colgroup>

		<tr>
			<th>
			    <span>Analog ROI Processing</span>
			</th>
			<th class="section">
				<form id="analog_enabled_form">
					<select style="font-weight:bold" class="classvisibility_init" name="analog.enabled" id="analog_enabled_value"
								onchange="setClassVisibility('classvisibility_analog_enabled', this.value);
								this.value == 'true' ? $(analog_debug_saveroiimages_value).trigger('onchange') : null;
								gatherChangedParameter(this.form)">
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</th>
			<th hidden>$TOOLTIP_analog_enabled</th>
		</tr>

		<tr class="classvisibility_analog_enabled">
			<td class="indent1">
			    <span>Model</span>
			</td>
			<td>
				<form id="analog_model_form">
					<select class="select_large" name="analog.model" id="analog_model_value"
						onchange="gatherChangedParameter(this.form)">
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_analog_model</td>
		</tr>

		<tr class="classvisibility_analog_enabled">
			<td style="padding-top:25px" colspan="3">
				<b>Debug</b>
			</td>
		</tr>

		<tr class="classvisibility_analog_enabled expert">
			<td class="indent1">
				<span>Save ROI Images</span>
			</td>
			<td>
				<form id="analog_debug_saveroiimages_form">
					<select name="analog.debug.saveroiimages" id="analog_debug_saveroiimages_value"
							onchange='setClassVisibility("classvisibility_analog_debug_saveroiimages", this.value);
										gatherChangedParameter(this.form)'>
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_analog_debug_saveroiimages</td>
		</tr>

		<tr class="classvisibility_analog_enabled classvisibility_analog_debug_saveroiimages expert">
			<td class="indent2">
				<span>ROI Images Location</span>
			</td>
			<td>
				<form id="analog_debug_roiimageslocation_form">
					<input required type="text"
						name="analog.debug.roiimageslocation" id="analog_debug_roiimageslocation_value" placeholder="/log/analog"
						onchange="gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_analog_debug_roiimageslocation</td>
		</tr>

		<tr class="classvisibility_analog_enabled classvisibility_analog_debug_saveroiimages expert">
			<td class="indent2">
				<span>ROI Images Retention</span>
			</td>
			<td>
				<form id="analog_debug_roiimagesretention_form">
					<input required type="number" min="0" value="5"
						name="analog.debug.roiimagesretention" id="analog_debug_roiimagesretention_value"
						onchange="(!validity.rangeUnderflow||(value=0));gatherChangedParameter(this.form, true)">Days
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_analog_debug_roiimagesretention</td>
		</tr>
	</table>


	<!-- Post-Processing -->
	<table class="table">
		<colgroup>
			<col span="1" style="width:310px">
			<col span="1" style="width:310px;">
			<col span="1">
		</colgroup>

		<tr>
			<th colspan="3">Post-Processing</th>
		</tr>

		<tr style="margin-top:12px">
			<td style="padding-top:25px"><b>Parameter per number sequence</b></td>
			<td style="padding-top:25px" colspan="2">
				<form class="postprocessing_per_sequence" id="postprocessing_sequence_sequencename_form">
					<select class="classvisibility_init" style="font-weight:bold"
							name="postprocessing.sequence.0.sequencename" id="postprocessing_sequence_0_sequencename_value"
							onchange="sequenceSelectAfterChange('postprocessing_per_sequence', this.id);
								setClassVisibility('classvisibility_postprocessing_maxratechecktype',
								$('[id$=\'maxratechecktype_value\']').val() > '0');gatherChangedParameter(this.form)">
					</select>
				</form>
			</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Decimal Shift</span>
			</td>
			<td>
				<form class="postprocessing_per_sequence" id="postprocessing_sequence_decimalshift_form">
					<input required type="number" min="-9" max="9" value="0"
						name="postprocessing.sequence.0.decimalshift" id="postprocessing_sequence_0_decimalshift_value"
						onchange="(!validity.rangeUnderflow||(value=-9)) && (!validity.rangeOverflow||(value=9));
							gatherChangedParameter(this.form, true);gatherChangedParameter(postprocessing_sequence_sequencename_form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_postprocessing_sequence_decimalshift</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Analog/Digit Sync Value</span>
			</td>
			<td>
				<form class="postprocessing_per_sequence" id="postprocessing_sequence_analogdigitsyncvalue_form">
					<input required type="number" min="6.0" max="9.9" step="0.1" value="9.2"
						name="postprocessing.sequence.0.analogdigitsyncvalue" id="postprocessing_sequence_0_analogdigitsyncvalue_value"
						onchange="(!validity.rangeUnderflow||(value=6.0)) && (!validity.rangeOverflow||(value=9.9)) &&
							(!validity.stepMismatch||(value=this.value));gatherChangedParameter(this.form);
							gatherChangedParameter(postprocessing_sequence_sequencename_form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_postprocessing_sequence_analogdigitsyncvalue</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Extended Resolution</span>
			</td>
			<td>
				<form class="postprocessing_per_sequence" id="postprocessing_sequence_extendedresolution_form">
					<select name="postprocessing.sequence.0.extendedresolution" id="postprocessing_sequence_0_extendedresolution_value"
							onchange="gatherChangedParameter(this.form);gatherChangedParameter(postprocessing_sequence_sequencename_form)">
						<option value="false">Disabled</option>
						<option value="true" selected>Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_postprocessing_sequence_extendedresolution</td>
		</tr>

		<tr class="classvisibility_digit_model_class11 hidden">
			<td class="indent1">
				<span>Ignore Leading NaNs</span>
			</td>
			<td>
				<form class="postprocessing_per_sequence" id="postprocessing_sequence_ignoreleadingnan_form">
					<select name="postprocessing.sequence.0.ignoreleadingnan" id="postprocessing_sequence_0_ignoreleadingnan_value"
							onchange="gatherChangedParameter(this.form);gatherChangedParameter(postprocessing_sequence_sequencename_form)">
						<option value="false">Disabled</option>
						<option value="true" selected>Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_postprocessing_sequence_ignoreleadingnan</td>
		</tr>

		<tr class="classvisibility_digit_model_class11 hidden">
			<td class="indent1">
				<span>Check Digit Increase Consistency</span>
			</td>
			<td>
				<form class="postprocessing_per_sequence" id="postprocessing_sequence_checkdigitincreaseconsistency_form">
					<select name="postprocessing.sequence.0.checkdigitincreaseconsistency" id="postprocessing_sequence_0_checkdigitincreaseconsistency_value"
							onchange="gatherChangedParameter(this.form);gatherChangedParameter(postprocessing_sequence_sequencename_form)">
						<option value="false">Disabled</option>
						<option value="true" selected>Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_postprocessing_sequence_checkdigitincreaseconsistency</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Max Rate Check Type</span>
			</td>
			<td>
				<form class="postprocessing_per_sequence" id="postprocessing_sequence_maxratechecktype_form">
					<select class="classvisibility_init"
							name="postprocessing.sequence.0.maxratechecktype" id="postprocessing_sequence_0_maxratechecktype_value"
							onchange="setClassVisibility('classvisibility_postprocessing_maxratechecktype', this.value > '0');
								gatherChangedParameter(this.form, true);gatherChangedParameter(postprocessing_sequence_sequencename_form)">
						<option value="0" >No Rate Check</option>
						<option value="1" selected>Rate Per Minute</option>
						<option value="2">Rate Per Interval</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_postprocessing_sequence_maxratechecktype</td>
		</tr>

		<tr class="classvisibility_postprocessing_maxratechecktype">
			<td class="indent2">
				<span>Max Rate</span>
			</td>
			<td>
				<form class="postprocessing_per_sequence" id="postprocessing_sequence_maxrate_form">
					<input required type="number" min="0.001" step="0.001" value="0.150"
						name="postprocessing.sequence.0.maxrate" id="postprocessing_sequence_0_maxrate_value"
						onchange="(!validity.rangeUnderflow||(value=0.001)) && (!validity.stepMismatch||(value=this.value));
							gatherChangedParameter(this.form);gatherChangedParameter(postprocessing_sequence_sequencename_form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_postprocessing_sequence_maxrate</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Allow Negative Rate</span>
			</td>
			<td>
				<form class="postprocessing_per_sequence" id="postprocessing_sequence_allownegativerate_form">
					<select name="postprocessing.sequence.0.allownegativerate" id="postprocessing_sequence_0_allownegativerate_value"
							onchange="gatherChangedParameter(this.form);gatherChangedParameter(postprocessing_sequence_sequencename_form)">
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_postprocessing_sequence_allownegativerate</td>
		</tr>

		<tr class="expert">
			<td class="indent1">
				<span>Use Fallback Value</span>
			</td>
			<td>
				<form class="postprocessing_per_sequence" id="postprocessing_sequence_usefallbackvalue_form">
					<select class="classvisibility_init"
							name="postprocessing.sequence.0.usefallbackvalue" id="postprocessing_sequence_0_usefallbackvalue_value"
							onchange="setClassVisibility('classvisibility_postprocessing_usefallbackvalue', this.value);
								gatherChangedParameter(this.form);gatherChangedParameter(postprocessing_sequence_sequencename_form)">
						<option value="false">Disabled</option>
						<option value="true" selected>Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_postprocessing_sequence_usefallbackvalue</td>
		</tr>

		<tr class="classvisibility_postprocessing_usefallbackvalue expert">
			<td class="indent2">
				<span>Max. Age of Fallback Value</span>
			</td>
			<td>
				<form class="postprocessing_per_sequence" id="postprocessing_sequence_fallbackvalueagestartup_form">
					<input required type="number" min="0" value="720"
						name="postprocessing.sequence.0.fallbackvalueagestartup" id="postprocessing_sequence_0_fallbackvalueagestartup_value"
						onchange="(!validity.rangeUnderflow||(value=0));gatherChangedParameter(this.form, true);
							gatherChangedParameter(postprocessing_sequence_sequencename_form)">Minutes
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_postprocessing_sequence_fallbackvalueagestartup</td>
		</tr>

		<tr>
			<td style="padding-top:25px" colspan="3">
				<b>Debug</b>
			</td>
		</tr>

		<tr class="expert">
			<td class="indent1">
			    <span>Save Debug Info</span>
			</td>
			<td>
				<form id="postprocessing_debug_savedebuginfo_form">
					<select name="postprocessing.debug.savedebuginfo" id="postprocessing_debug_savedebuginfo_value"
							onchange="gatherChangedParameter(this.form)">
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_postprocessing_debug_savedebuginfo</td>
		</tr>
	</table>


	<!-- MQTT -->
	<table class="table">
		<colgroup>
			<col span="1" style="width:310px">
			<col span="1" style="width:310px;">
			<col span="1">
		</colgroup>

		<tr>
			<th>
			    <span>MQTT</span>
			</th>
			<th class="section">
				<form id="mqtt_enabled_form">
					<select style="font-weight:bold" class="classvisibility_init" name="mqtt.enabled" id="mqtt_enabled_value"
							onchange="setClassVisibility('classvisibility_mqtt_enabled', this.value);
								this.value == 'true' ? ($(mqtt_authmode_value).trigger('onchange'),
								$(mqtt_homeassistant_discoveryenabled_value).trigger('onchange')) : null;
								gatherChangedParameter(this.form)">
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</th>
			<th hidden>$TOOLTIP_mqtt_enabled</th>
		</tr>

		<tr class="classvisibility_mqtt_enabled">
			<td class="indent1">
				<span>URI</span>
			</td>
			<td>
				<form id="mqtt_uri_form">
					<input required type="text" name="mqtt.uri" id="mqtt_uri_value" placeholder="mqtt://192.168.x.x:1883"
						onchange="gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_mqtt_uri</td>
		</tr>

		<tr class="classvisibility_mqtt_enabled">
			<td class="indent1">
				<span>Main Topic</span>
			</td>
			<td>
				<form id="mqtt_maintopic_form">
					<input required type="text" name="mqtt.maintopic" id="mqtt_maintopic_value" placeholder="watermeter"
						onchange="gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_mqtt_maintopic</td>
		</tr>

		<tr class="classvisibility_mqtt_enabled">
			<td class="indent1">
				<span>Client ID</span>
			</td>
			<td>
				<form id="mqtt_clientid_form">
					<input required type="text" name="mqtt.clientid" id="mqtt_clientid_value" maxlength="23"
						pattern="^[A-Za-z0-9]+$" placeholder="watermeter" onchange="gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_mqtt_clientid</td>
		</tr>

		<tr class="classvisibility_mqtt_enabled">
			<td class="indent1">
				<span>Authentication</span>
			</td>
			<td>
				<form id="mqtt_authmode_form">
					<select name="mqtt.authmode" id="mqtt_authmode_value"
							onchange="this.value == '1' ? (setClassVisibility('classvisibility_mqtt_authmode_1', true),
														   setClassVisibility('classvisibility_mqtt_authmode_2', false)) :
	   								  this.value == '2' ? (setClassVisibility('classvisibility_mqtt_authmode_1', true),
										 				   setClassVisibility('classvisibility_mqtt_authmode_2', true),
									  						gatherChangedParameter(mqtt_tls_cacert_form),
															gatherChangedParameter(mqtt_tls_clientcert_form),
															gatherChangedParameter(mqtt_tls_clientkey_form)) :
						   								  (setClassVisibility('classvisibility_mqtt_authmode_1', false),
							   							   setClassVisibility('classvisibility_mqtt_authmode_2', false));
								gatherChangedParameter(this.form, true);">
						<option value="0" selected>None</option>
						<option value="1">Basic</option>
						<option value="2">TLS</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_mqtt_authmode</td>
		</tr>

		<tr class="classvisibility_mqtt_enabled classvisibility_mqtt_authmode_1">
			<td class="indent2">
				<span>Username</span>
			</td>
			<td>
				<form id="mqtt_username_form">
					<input type="text" name="mqtt.username" id="mqtt_username_value"
						onchange="gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_mqtt_username</td>
		</tr>

		<tr class="classvisibility_mqtt_enabled classvisibility_mqtt_authmode_1">
			<td class="indent2">
				<span>Password</span>
			</td>
			<td>
				<form id="mqtt_password_form">
					<input type="password" name="mqtt.password" id="mqtt_password_value" autocomplete="on"
						onchange="gatherChangedParameter(this.form)">
						<span toggle="#mqtt_password_value" class="fa fa-fw fa-eye field-icon toggle-password"></span>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_mqtt_password</td>
		</tr>

		<tr class="classvisibility_mqtt_enabled classvisibility_mqtt_authmode_2">
			<td class="indent2">
				<span>CA Certificate</span>
			</td>
			<td>
				<form id="mqtt_tls_cacert_form">
					<select class="select_large" name="mqtt.tls.cacert" id="mqtt_tls_cacert_value"
						onchange="gatherChangedParameter(this.form)">
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_mqtt_tls_cacert</td>
		</tr>

		<tr class="classvisibility_mqtt_enabled classvisibility_mqtt_authmode_2">
			<td class="indent2">
				<span>Client Certificate</span>
			</td>
			<td>
				<form id="mqtt_tls_clientcert_form">
					<select class="select_large" name="mqtt.tls.clientcert" id="mqtt_tls_clientcert_value"
						onchange="gatherChangedParameter(this.form)">
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_mqtt_tls_clientcert</td>
		</tr>

		<tr class="classvisibility_mqtt_enabled classvisibility_mqtt_authmode_2">
			<td class="indent2">
				<span>Client Key</span>
			</td>
			<td>
				<form id="mqtt_tls_clientkey_form">
					<select class="select_large" name="mqtt.tls.clientkey" id="mqtt_tls_clientkey_value"
						onchange="gatherChangedParameter(this.form)">
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_mqtt_tls_clientkey</td>
		</tr>

		<tr class="classvisibility_mqtt_enabled">
			<td class="indent1">
				<span>Process Data Notation</span>
			</td>
			<td>
				<form id="mqtt_processdatanotation_form">
					<select name="mqtt.processdatanotation" id="mqtt_processdatanotation_value"
							onchange="gatherChangedParameter(this.form, true)">
						<option value="0" selected>JSON Topic</option>
						<option value="1">Single Topics</option>
						<option value="2">JSON + Topics</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_mqtt_processdatanotation</td>
		</tr>

		<tr class="classvisibility_mqtt_enabled">
			<td class="indent1">
				<span>Retain Process Data</span>
			</td>
			<td>
				<form id="mqtt_retainprocessdata_form">
					<select name="mqtt.retainprocessdata" id="mqtt_retainprocessdata_value"
							onchange="gatherChangedParameter(this.form)">
						<option value="false">Disabled</option>
						<option value="true" selected>Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_mqtt_retainprocessdata</td>
		</tr>

		<tr class="classvisibility_mqtt_enabled">
			<td class="indent1">
				<span>Home Assistant Discovery</span>
			</td>
			<td>
				<form id="mqtt_homeassistant_discoveryenabled_form">
					<select name="mqtt.homeassistant.discoveryenabled" id="mqtt_homeassistant_discoveryenabled_value"
							onchange="setClassVisibility('classvisibility_mqtt_homeassistant_discoveryenabled', this.value);
								gatherChangedParameter(this.form)">
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_mqtt_homeassistant_discoveryenabled</td>
		</tr>

		<tr class="classvisibility_mqtt_enabled classvisibility_mqtt_homeassistant_discoveryenabled">
			<td class="indent2">
				<span id="MQTT_HADiscoveryPrefix_text">Discovery Prefix</span>
			</td>
			<td>
				<form id="mqtt_homeassistant_discoveryprefix_form">
					<input required type="text" name="mqtt.homeassistant.discoveryprefix" id="mqtt_homeassistant_discoveryprefix_value"
						placeholder="homeassistant" onchange="gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_mqtt_homeassistant_discoveryprefix</td>
		</tr>

		<tr class="classvisibility_mqtt_enabled classvisibility_mqtt_homeassistant_discoveryenabled">
			<td class="indent2">
				<span id="MQTT_HAStatusTopic_text">Status Topic</span>
			</td>
			<td>
				<form id="mqtt_homeassistant_statustopic_form">
					<input required type="text" name="mqtt.homeassistant.statustopic" id="mqtt_homeassistant_statustopic_value"
						placeholder="homeassistant/status" onchange="gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_mqtt_homeassistant_statustopic</td>
		</tr>

		<tr class="classvisibility_mqtt_enabled classvisibility_mqtt_homeassistant_discoveryenabled">
			<td class="indent2">
				<span id="MQTT_HAMeterType_text">Meter Type</span>
			</td>
			<td>
				<form id="mqtt_homeassistant_metertype_form">
					<!--  See https://developers.home-assistant.io/docs/core/entity/sensor/#available-device-classes -->
					<select class="select_large" name="mqtt.homeassistant.metertype" id="mqtt_homeassistant_metertype_value"
							onchange="gatherChangedParameter(this.form, true)">
						<option value="0">None (no Units)</option>
						<option value="1" selected>Watermeter (Value: m, Rate: m/h)</option>
						<option value="2">Watermeter (Value: l, Rate: l/h)</option>
						<option value="3">Watermeter (Value: gal, Rate: gal/h)</option>
						<option value="4">Watermeter (Value: ft, Rate: ft/m)</option>
						<option value="5">Gasmeter (Value: m, Rate: m/h)</option>
						<option value="6">Gasmeter (Value: ft, Rate: ft/m)</option>
						<option value="7">Energymeter (Value: Wh, Rate: W)</option>
						<option value="8">Energymeter (Value: kWh, Rate: kW)</option>
						<option value="9">Energymeter (Value: MWh, Rate: MW)</option>
						<option value="10">Energymeter (Value: GJ, Rate: GJ/h)</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_mqtt_homeassistant_metertype</td>
		</tr>

		<tr class="classvisibility_mqtt_enabled classvisibility_mqtt_homeassistant_discoveryenabled">
			<td class="indent2">
				<span>Retain Discovery Topics</span>
			</td>
			<td>
				<form id="mqtt_homeassistant_retaindiscovery_form">
					<select name="mqtt.homeassistant.retaindiscovery" id="mqtt_homeassistant_retaindiscovery_value"
							onchange="gatherChangedParameter(this.form)">
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_mqtt_homeassistant_retaindiscovery</td>
		</tr>
	</table>


	<!-- INFLUXDB v1 -->
	<table class="table">
		<colgroup>
			<col span="1" style="width:310px">
			<col span="1" style="width:310px;">
			<col span="1">
		</colgroup>

		<tr>
			<th>
			    <span>InfluxDB v1.x</span>
			</th>
			<th class="section">
				<form id="influxdbv1_enabled_form">
					<select style="font-weight:bold" class="classvisibility_init" name="influxdbv1.enabled" id="influxdbv1_enabled_value"
							onchange="setClassVisibility('classvisibility_influxdbv1_enabled', this.value);
								this.value == 'true' ? $(influxdbv1_authmode_value).trigger('onchange') : null;
								gatherChangedParameter(this.form)">
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</th>
			<th hidden>$TOOLTIP_influxdbv1_enabled</th>
		</tr>

		<tr class="classvisibility_influxdbv1_enabled">
			<td class="indent1">
				<span>URI</span>
			</td>
			<td>
				<form id="influxdbv1_uri_form">
					<input required type="text" name="influxdbv1.uri" id="influxdbv1_uri_value" placeholder="http://192.168.x.x:8086"
						onchange="gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_influxdbv1_uri</td>
		</tr>

        <tr class="classvisibility_influxdbv1_enabled">
			<td class="indent1">
				<span>Database</span>
			</td>
			<td>
				<form id="influxdbv1_database_form">
					<input required type="text" name="influxdbv1.database" id="influxdbv1_database_value" placeholder="watermeter"
						onchange="gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_influxdbv1_database</td>
		</tr>

		<tr class="classvisibility_influxdbv1_enabled">
			<td class="indent1">
				<span>Authentication / Security</span>
			</td>
			<td>
				<form id="influxdbv1_authmode_form">
					<select name="influxdbv1.authmode" id="influxdbv1_authmode_value"
							onload=""
							onchange="this.value == '1' ? (setClassVisibility('classvisibility_influxdbv1_authtls', 'false'),
														   setClassVisibility('classvisibility_influxdbv1_authbasic', 'true')) :
									  this.value == '2' ? (setClassVisibility('classvisibility_influxdbv1_authtls', 'true'),
									  						gatherChangedParameter(influxdbv1_tls_cacert_form),
															gatherChangedParameter(influxdbv1_tls_clientcert_form),
															gatherChangedParameter(influxdbv1_tls_clientkey_form)) :
														  (setClassVisibility('classvisibility_influxdbv1_authbasic', 'false'),
									   					   setClassVisibility('classvisibility_influxdbv1_authtls', 'false'));
										gatherChangedParameter(this.form, true)">
						<option value="0" selected>None</option>
						<option value="1">Basic</option>
						<option value="2">TLS</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_influxdbv1_authmode</td>
		</tr>

		<tr class="classvisibility_influxdbv1_enabled classvisibility_influxdbv1_authbasic classvisibility_influxdbv1_authtls">
			<td class="indent2">
				<span>Username</span>
			</td>
			<td>
				<form id="influxdbv1_username_form">
					<input type="text" name="influxdbv1.username" id="influxdbv1_username_value"
						onchange="gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_influxdbv1_username</td>
		</tr>

		<tr class="classvisibility_influxdbv1_enabled classvisibility_influxdbv1_authbasic classvisibility_influxdbv1_authtls">
			<td class="indent2">
				<span>Password</span>
			</td>
			<td>
				<form id="influxdbv1_password_form">
					<input type="password" name="influxdbv1.password" id="influxdbv1_password_value" autocomplete="on"
						onchange="gatherChangedParameter(this.form)">
						<span toggle="#influxdbv1_password_value" class="fa fa-fw fa-eye field-icon toggle-password"></span>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_influxdbv1_password</td>
		</tr>

		<tr class="classvisibility_influxdbv1_enabled classvisibility_influxdbv1_authtls">
			<td class="indent2">
				<span>CA Certificate</span>
			</td>
			<td>
				<form id="influxdbv1_tls_cacert_form">
					<select class="select_large" name="influxdbv1.tls.cacert" id="influxdbv1_tls_cacert_value"
						onchange="gatherChangedParameter(this.form)">
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_influxdbv1_tls_cacert</td>
		</tr>

		<tr class="classvisibility_influxdbv1_enabled classvisibility_influxdbv1_authtls">
			<td class="indent2">
				<span>Client Certificate</span>
			</td>
			<td>
				<form id="influxdbv1_tls_clientcert_form">
					<select class="select_large" name="influxdbv1.tls.clientcert" id="influxdbv1_tls_clientcert_value"
						onchange="gatherChangedParameter(this.form)">
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_influxdbv1_tls_clientcert</td>
		</tr>

		<tr class="classvisibility_influxdbv1_enabled classvisibility_influxdbv1_authtls">
			<td class="indent2">
				<span>Client Key</span>
			</td>
			<td>
				<form id="influxdbv1_tls_clientkey_form">
					<select class="select_large" name="influxdbv1.tls.clientkey" id="influxdbv1_tls_clientkey_value"
						onchange="gatherChangedParameter(this.form)">
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_influxdbv1_tls_clientkey</td>
		</tr>

		<tr class="classvisibility_influxdbv1_enabled" style="margin-top:12px">
			<td style="padding-top:25px"><b>Parameter per number sequence</b></td>
			<td style="padding-top:25px" colspan="2">
				<form class="influxdbv1_per_sequence" id="influxdbv1_sequence_sequencename_form">
					<select class="classvisibility_init" style="font-weight:bold"
							name="influxdbv1.sequence.0.sequencename" id="influxdbv1_sequence_0_sequencename_value"
							onchange="sequenceSelectAfterChange('influxdbv1_per_sequence', this.id);gatherChangedParameter(this.form)">
					</select>
				</form>
			</td>
		</tr>

		<tr class="classvisibility_influxdbv1_enabled">
			<td class="indent1">
				<span>Measurement Name</span>
			</td>
			<td>
				<form class="influxdbv1_per_sequence" id="influxdbv1_sequence_measurementname_form">
					<input required type="text"
						name="influxdbv1.sequence.0.measurementname" id="influxdbv1_sequence_0_measurementname_value" placeholder="watermeter"
						onchange="gatherChangedParameter(this.form);gatherChangedParameter(influxdbv1_sequence_sequencename_form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_influxdbv1_sequence_measurementname</td>
		</tr>

		<tr class="classvisibility_influxdbv1_enabled">
			<td class="indent1">
				<span >Field Key [Actual Value]</span>
			</td>
			<td>
				<form class="influxdbv1_per_sequence" id="influxdbv1_sequence_fieldkey1_form">
					<input required type="text"
						name="influxdbv1.sequence.0.fieldkey1" id="influxdbv1_sequence_0_fieldkey1_value" placeholder="value"
						onchange="gatherChangedParameter(this.form);gatherChangedParameter(influxdbv1_sequence_sequencename_form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_influxdbv1_sequence_fieldkey1</td>
		</tr>
	</table>


	<!-- INFLUXDB v2 -->
	<table class="table">
		<colgroup>
			<col span="1" style="width:310px">
			<col span="1" style="width:310px;">
			<col span="1">
		</colgroup>

		<tr>
			<th>
			    <span>InfluxDB v2.x</span>
			</th>
			<th class="section">
				<form id="influxdbv2_enabled_form">
					<select style="font-weight:bold" class="classvisibility_init" name="influxdbv2.enabled" id="influxdbv2_enabled_value"
							onchange="setClassVisibility('classvisibility_influxdbv2_enabled', this.value);
								this.value == 'true' ? $(influxdbv2_authmode_value).trigger('onchange') : null;
								gatherChangedParameter(this.form)">
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</th>
			<th hidden>$TOOLTIP_influxdbv2_enabled</th>
		</tr>

		<tr class="classvisibility_influxdbv2_enabled">
			<td class="indent1">
				<span>URI</span>
			</td>
			<td>
				<form id="influxdbv2_uri_form">
					<input required type="text" name="influxdbv2.uri" id="influxdbv2_uri_value" placeholder="http://192.168.x.x:8086"
						onchange="gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_influxdbv2_uri</td>
		</tr>

        <tr class="classvisibility_influxdbv2_enabled">
			<td class="indent1">
				<span>Bucket</span>
			</td>
			<td>
				<form id="influxdbv2_database_form">
					<input required type="text" name="influxdbv2.bucket" id="influxdbv2_bucket_value" placeholder="watermeter"
						onchange="gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_influxdbv2_bucket</td>
		</tr>

		<tr class="classvisibility_influxdbv2_enabled">
			<td class="indent1">
				<span>Organization</span>
			</td>
			<td>
				<form id="influxdbv2_organization_form">
					<input required type="text" name="influxdbv2.organization" id="influxdbv2_organization_value"
						placeholder="organization" onchange="gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_influxdbv2_organization</td>
		</tr>

		<tr class="classvisibility_influxdbv2_enabled">
			<td class="indent1">
				<span>Authentication / Security</span>
			</td>
			<td>
				<form id="influxdbv2_authmode_form">
					<select name="influxdbv2.authmode" id="influxdbv2_authmode_value"
							onchange="this.value == '2' ? (setClassVisibility('classvisibility_influxdbv2_authmode_2', 'true'),
															gatherChangedParameter(influxdbv2_tls_cacert_form),
															gatherChangedParameter(influxdbv2_tls_clientcert_form),
															gatherChangedParameter(influxdbv2_tls_clientkey_form)) :
														  setClassVisibility('classvisibility_influxdbv2_authmode_2', 'false');
								gatherChangedParameter(this.form, true)">
						<option value="1" selected>Token</option>
						<option value="2">TLS</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_influxdbv2_authmode</td>
		</tr>

		<tr class="classvisibility_influxdbv2_enabled">
			<td class="indent2">
				<span>Token</span>
			</td>
			<td>
				<form id="influxdbv2_token_form">
					<input type="password" name="influxdbv2.token" id="influxdbv2_token_value" autocomplete="on"
						onchange="gatherChangedParameter(this.form)">
					<span toggle="#influxdbv2_token_value" class="fa fa-fw fa-eye field-icon toggle-password"></span>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_influxdbv2_token</td>
		</tr>

		<tr class="classvisibility_influxdbv2_enabled classvisibility_influxdbv2_authmode_2">
			<td class="indent2">
				<span>CA Certificate</span>
			</td>
			<td>
				<form id="influxdbv2_tls_cacert_form">
					<select class="select_large" name="influxdbv2.tls.cacert" id="influxdbv2_tls_cacert_value"
						onchange="gatherChangedParameter(this.form)">
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_influxdbv2_tls_cacert</td>
		</tr>

		<tr class="classvisibility_influxdbv2_enabled classvisibility_influxdbv2_authmode_2">
			<td class="indent2">
				<span>Client Certificate</span>
			</td>
			<td>
				<form id="influxdbv2_tls_clientcert_form">
					<select class="select_large" name="influxdbv2.tls.clientcert" id="influxdbv2_tls_clientcert_value"
						onchange="gatherChangedParameter(this.form)">
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_influxdbv2_tls_clientcert</td>
		</tr>

		<tr class="classvisibility_influxdbv2_enabled classvisibility_influxdbv2_authmode_2">
			<td class="indent2">
				<span>Client Key</span>
			</td>
			<td>
				<form id="influxdbv2_tls_clientkey_form">
					<select class="select_large" name="influxdbv2.tls.clientkey" id="influxdbv2_tls_clientkey_value"
						onchange="gatherChangedParameter(this.form)">
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_influxdbv2_tls_clientkey</td>
		</tr>

		<tr class="classvisibility_influxdbv2_enabled" style="margin-top:12px">
			<td style="padding-top:25px"><b>Parameter per number sequence</b></td>
			<td style="padding-top:25px" colspan="2">
				<form class="influxdbv2_per_sequence" id="influxdbv2_sequence_sequencename_form">
					<select class="classvisibility_init" style="font-weight:bold"
							name="influxdbv2.sequence.0.sequencename" id="influxdbv2_sequence_0_sequencename_value"
							onchange="sequenceSelectAfterChange('influxdbv2_per_sequence', this.id);gatherChangedParameter(this.form)">
					</select>
				</form>
			</td>
		</tr>

		<tr class="classvisibility_influxdbv2_enabled">
			<td class="indent1">
				<span>Measurement Name</span>
			</td>
			<td>
				<form class="influxdbv2_per_sequence" id="influxdbv2_sequence_measurementname_form">
					<input required type="text"
						name="influxdbv2.sequence.0.measurementname" id="influxdbv2_sequence_0_measurementname_value" placeholder="watermeter"
						onchange="gatherChangedParameter(this.form);gatherChangedParameter(influxdbv2_sequence_sequencename_form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_influxdbv2_sequence_measurementname</td>
		</tr>

		<tr class="classvisibility_influxdbv2_enabled">
			<td class="indent1">
				<span >Field Key [Actual Value]</span>
			</td>
			<td>
				<form class="influxdbv2_per_sequence" id="influxdbv2_sequence_fieldkey1_form">
					<input required type="text"
						name="influxdbv2.sequence.0.fieldkey1" id="influxdbv2_sequence_0_fieldkey1_value" placeholder="value"
						onchange="gatherChangedParameter(this.form);gatherChangedParameter(influxdbv2_sequence_sequencename_form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_influxdbv2_sequence_fieldkey1</td>
		</tr>
	</table>


	<!-- GPIO -->
	<table class="table">
		<colgroup>
			<col span="1" style="width:310px">
			<col span="1" style="width:310px;">
			<col span="1">
		</colgroup>

		<tr>
			<th>
			    <span>GPIO (General Purpose Input/Output)</span>
			</th>
			<th class="section">
				<form id="gpio_customizationenabled_form">
					<select style="font-weight:bold" class="classvisibility_init"
							name="gpio.customizationenabled" id="gpio_customizationenabled_value"
							onchange="setClassVisibility('classvisibility_gpio_customizationenabled', this.value);
								this.value == 'true' ? $('[id$=\'pinenabled_value\']').trigger('onchange') : null;
								gatherChangedParameter(this.form)">
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</th>
			<th hidden>$TOOLTIP_gpio_customizationenabled</th>
		</tr>

		<tr class="classvisibility_gpio_customizationenabled classexpert_gpio">
			<td>
				<span style="font-weight:bold">Pin Selection</span>
			</td>
			<td>
				<form class="form_gpio_config" id="gpio_gpiopin_gpionumber_form">
					<select style="font-weight:bold" class="classvisibility_init"
							name="gpio.gpiopin.0.gpionumber" id="gpio_gpiopin_0_gpionumber_value"
							onchange="gpioPinSelectAfterChange(); gatherChangedParameter(this.form, true)">
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_gpio_gpiopin_gpionumber</td>
		</tr>

		<tr class="classvisibility_gpio_customizationenabled classexpert_gpio">
			<td>
				<span>Pin Status</span>
			</td>
			<td>
				<form class="form_gpio_config" id="gpio_gpiopin_pinenabled_form">
					<select name="gpio.gpiopin.0.pinenabled" id="gpio_gpiopin_0_pinenabled_value"
							onchange="setClassVisibility('classvisibility_gpio_gpiopin_pinenabled', this.value);
								this.value == 'true' ? $('[id$=\'pinmode_value\']').trigger('onchange') : null;
								gatherChangedParameter(gpio_gpiopin_gpionumber_form, true);gatherChangedParameter(this.form)">
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_gpio_gpiopin_pinenabled</td>
		</tr>

		<tr class="classvisibility_gpio_customizationenabled classvisibility_gpio_gpiopin_pinenabled classexpert_gpio">
			<td class="indent1">
				<span>Pin Mode</span>
				<span id="gpio_gpiopin_pinmode_restrictedusagetext" style="display:none; color:red;"></span>
			</td>
			<td>
				<form class="form_gpio_config" id="gpio_gpiopin_pinmode_form">
					<select name="gpio.gpiopin.0.pinmode" id="gpio_gpiopin_0_pinmode_value"
							onchange='gpioPinModeChanged();gatherChangedParameter(gpio_gpiopin_gpionumber_form, true);
								gatherChangedParameter(this.form)'>
						<option value="flashlight-default">flashlight-default</option>
						<option value="flashlight-pwm">flashlight-pwm</option>
						<option value="flashlight-smartled">flashlight-smartled</option>
						<option value="flashlight-digital">flashlight-digital</option>
						<option value="input" selected>input</option>
						<option value="input-pullup">input-pullup</option>
						<option value="input-pulldown">input-pulldown</option>
						<option value="output">output</option>
						<option value="output-pwm">output-pwm</option>
						<option value="trigger-cycle-start">trigger-cycle-start</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_gpio_gpiopin_pinmode</td>
		</tr>

		<tr class="classvisibility_gpio_customizationenabled classvisibility_gpio_gpiopin_pinenabled gpio_show_capture_mode classexpert_gpio">
			<td class="indent1">
				<span>Pin Capture Mode</span>
			</td>
			<td>
				<form class="form_gpio_config" id="gpio_gpiopin_capturemode_form">
					<select name="gpio.gpiopin.0.capturemode" id="gpio_gpiopin_0_capturemode_value"
							onchange='gpioPinModeChanged(); gatherChangedParameter(gpio_gpiopin_gpionumber_form, true);
								gatherChangedParameter(this.form)'>
						<option value="cyclic-polling" selected>cyclic-polling</option>
						<option value="interrupt-rising-edge">interrupt-rising-edge</option>
						<option value="interrupt-falling-edge">interrupt-falling-edge</option>
						<option value="interrupt-rising-falling">interrupt-rising-falling</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_gpio_gpiopin_capturemode</td>
		</tr>

		<tr class="classvisibility_gpio_customizationenabled classvisibility_gpio_gpiopin_pinenabled gpio_show_debounce_time classexpert_gpio">
			<td class="indent1">
				<span>Input Debounce Time</span>
			</td>
			<td>
				<form class="form_gpio_config" id="gpio_gpiopin_inputdebouncetime_form">
					<input required type="number" min="0" max="5000" value="500"
						name="gpio.gpiopin.0.inputdebouncetime" id="gpio_gpiopin_0_inputdebouncetime_value"
						onchange="(!validity.rangeUnderflow||(value=0)) && (!validity.rangeOverflow||(value=5000));
							gatherChangedParameter(gpio_gpiopin_gpionumber_form, true);gatherChangedParameter(this.form, true)">ms
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_gpio_gpiopin_inputdebouncetime</td>
		</tr>

		<tr class="classvisibility_gpio_customizationenabled classvisibility_gpio_gpiopin_pinenabled gpio_show_pwm_frequency classexpert_gpio">
			<td class="indent1">
				<span>Pin PWM Frequency</span>
			</td>
			<td>
				<form class="form_gpio_config" id="gpio_gpiopin_pwmfrequency_form">
					<input style="min-width:90px" required type="number" min="5" max="1000000" value="5000"
						name="gpio.gpiopin.0.pwmfrequency" id="gpio_gpiopin_0_pwmfrequency_value"
						onchange="(!validity.rangeUnderflow||(value=5)) && (!validity.rangeOverflow||(value=1000000));
							gatherChangedParameter(gpio_gpiopin_gpionumber_form, true);gatherChangedParameter(this.form, true)">Hz
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_gpio_gpiopin_pwmfrequency</td>
		</tr>

		<tr class="classvisibility_gpio_customizationenabled classvisibility_gpio_gpiopin_pinenabled classexpert_gpio">
			<td class="indent1">
				<span>Pin Expose To REST</span>
			</td>
			<td>
				<form class="form_gpio_config" id="gpio_gpiopin_exposetorest_form">
					<select name="gpio.gpiopin.0.exposetorest" id="gpio_gpiopin_0_exposetorest_value"
							onchange='gatherChangedParameter(gpio_gpiopin_gpionumber_form, true);gatherChangedParameter(this.form)'>
						<option value="false">Disabled</option>
						<option value="true" selected>Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_gpio_gpiopin_exposetorest</td>
		</tr>

		<tr class="classvisibility_gpio_customizationenabled classvisibility_gpio_gpiopin_pinenabled classexpert_gpio">
			<td class="indent1">
				<span>Pin Expose To MQTT</span>
			</td>
			<td>
				<form class="form_gpio_config" id="gpio_gpiopin_exposetomqtt_form">
					<select name="gpio.gpiopin.0.exposetomqtt" id="gpio_gpiopin_0_exposetomqtt_value"
							onchange='gatherChangedParameter(gpio_gpiopin_gpionumber_form, true);gatherChangedParameter(this.form)'>
						<option value="false">Disabled</option>
						<option value="true" selected>Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_gpio_gpiopin_exposetomqtt</td>
		</tr>

		<tr class="classvisibility_gpio_customizationenabled classvisibility_gpio_gpiopin_pinenabled classexpert_gpio">
			<td class="indent1">
				<span>Pin Name</span>
			</td>
			<td>
				<form class="form_gpio_config" id="gpio_gpiopin_pinname_form">
					<input type="text" name="gpio.gpiopin.0.pinname" id="gpio_gpiopin_0_pinname_value" placeholder="gpioX"
						onchange='gatherChangedParameter(gpio_gpiopin_gpionumber_form, true);gatherChangedParameter(this.form)'>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_gpio_gpiopin_pinname</td>
		</tr>

		<tr class="classvisibility_gpio_customizationenabled classvisibility_gpio_gpiopin_pinenabled gpio_show_smartled classexpert_gpio">
			<td class="indent1">
				<span>LED Type</span>
			</td>
			<td>
				<form class="form_gpio_config" id="gpio_gpiopin_smartled_type_form">
					<select name="gpio.gpiopin.0.smartled.type" id="gpio_gpiopin_0_smartled_type_value"
							onchange='gatherChangedParameter(gpio_gpiopin_gpionumber_form, true);gatherChangedParameter(this.form, true)'>
						<option value="0" selected>WS2812</option>
						<option value="1">WS2812B (universal)</option>
						<option value="2">WS2812B (newer variant)</option>
						<option value="3">WS2812B (older variant)</option>
						<option value="4">SK6812</option>
						<option value="5">WS2813</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_gpio_gpiopin_smartled_type</td>
		</tr>

		<tr class="classvisibility_gpio_customizationenabled classvisibility_gpio_gpiopin_pinenabled gpio_show_smartled classexpert_gpio">
			<td class="indent1">
				<span>LED Quantity</span>
			</td>
			<td>
				<form class="form_gpio_config" id="gpio_gpiopin_smartled_quantity_form">
					<input required type="number" min="1" value="1"
						name="gpio.gpiopin.0.smartled.quantity" id="gpio_gpiopin_0_smartled_quantity_value"
						onchange="(!validity.rangeUnderflow||(value=1));gatherChangedParameter(gpio_gpiopin_gpionumber_form, true);
							gatherChangedParameter(this.form, true)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_gpio_gpiopin_smartled_quantity</td>
		</tr>

		<tr class="classvisibility_gpio_customizationenabled classvisibility_gpio_gpiopin_pinenabled gpio_show_smartled classexpert_gpio">
			<td class="indent1">
				<span>LED Color</span>
			</td>
			<td>
				<form class="form_gpio_config" id="gpio_gpiopin_smartled_color_form">
					R <input required style="min-width:45px;width:45px;" type="number" min="0" max="255" value="255"
							name="gpio.gpiopin.0.smartled.colorredchannel" id="gpio_gpiopin_0_smartled_colorredchannel_value"
							onchange="(!validity.rangeUnderflow||(value=0)) && (!validity.rangeOverflow||(value=255));
								gatherChangedParameter(gpio_gpiopin_gpionumber_form, true);gatherChangedParameter(this.form, true)">

					G <input required style="min-width:45px;width:45px" type="number" min="0" max="255" value="255"
							name="gpio.gpiopin.0.smartled.colorgreenchannel" id="gpio_gpiopin_0_smartled_colorgreenchannel_value"
							onchange="(!validity.rangeUnderflow||(value=0)) && (!validity.rangeOverflow||(value=255));
								gatherChangedParameter(gpio_gpiopin_gpionumber_form, true);gatherChangedParameter(this.form, true)">

					B <input required style="min-width:45px;width:45px" type="number" min="0" max="255" value="255"
							name="gpio.gpiopin.0.smartled.colorbluechannel" id="gpio_gpiopin_0_smartled_colorbluechannel_value"
							onchange="(!validity.rangeUnderflow||(value=0)) && (!validity.rangeOverflow||(value=255));
								gatherChangedParameter(gpio_gpiopin_gpionumber_form, true);gatherChangedParameter(this.form, true)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_gpio_gpiopin_smartled_color</td>
		</tr>

		<tr class="classvisibility_gpio_customizationenabled classvisibility_gpio_gpiopin_pinenabled gpio_show_smartled gpio_show_intersity_correction classexpert_gpio">
			<td class="indent1">
				<span>LED Intensity Correction Factor</span>
			</td>
			<td>
				<form class="form_gpio_config" id="gpio_gpiopin_intensitycorrectionfactor_form">
				<input required type="number" min="1" max="100" value="100"
					name="gpio.gpiopin.0.intensitycorrectionfactor" id="gpio_gpiopin_0_intensitycorrectionfactor"
					onchange="(!validity.rangeUnderflow||(value=1)) && (!validity.rangeOverflow||(value=100));
						gatherChangedParameter(gpio_gpiopin_gpionumber_form, true);gatherChangedParameter(this.form, true)">%
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_gpio_gpiopin_intensitycorrectionfactor</td>
		</tr>
	</table>


	<!-- Log -->
	<table class="table">
		<colgroup>
			<col span="1" style="width:310px">
			<col span="1" style="width:310px;">
			<col span="1">
		</colgroup>
		<tr>
			<th colspan="3">Log</th>
		</tr>

		<tr>
			<td style="padding-top:25px" colspan="3">
				<b>Debug</b>
			</td>
		</tr>

		<tr>
			<td class="indent1">
			    <span>Log Level</span>
			</td>
			<td>
				<form id="log_debug_loglevel_form">
					<select name="log.debug.loglevel" id="log_debug_loglevel_value"
							onchange="gatherChangedParameter(this.form, true)">
							<option value="1">Error</option> <!--  matches esp_log_level_t -->
							<option value="2" selected>Warning</option>
							<option value="3">Info</option>
							<option value="4">Debug</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_log_debug_loglevel</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Log Files Retention</span>
			</td>
			<td>
				<form id="log_debug_logfilesretention_form">
					<input required type="number" min="0" value="5"
						name="log.debug.logfilesretention" id="log_debug_logfilesretention_value"
						onchange="(!validity.rangeUnderflow||(value=0));gatherChangedParameter(this.form, true)">Days
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_log_debug_logfilesretention</td>
		</tr>

		<tr class="expert">
			<td class="indent1">
				<span>Debug Files Retention</span>
			</td>
			<td>
				<form id="log_debug_debuglogfilesretention_form">
					<input required type="number" min="0" value="5"
						name="log_debug_debugfilesretention" id="log_debug_debugfilesretention_value"
						onchange="(!validity.rangeUnderflow||(value=0));gatherChangedParameter(this.form, true)">Days
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_log_debug_debugfilesretention</td>
		</tr>

		<tr>
			<td style="padding-top:25px" colspan="3">
				<b>Data</b>
			</td>
		</tr>

		<tr>
			<td class="indent1">
			    <span>Data Log</span>
			</td>
			<td>
				<form id="log_data_enabled_form">
					<select class="classvisibility_init" name="log.data.enabled" id="log_data_enabled_value"
							onchange="setClassVisibility('classvisibility_log_data_enabled', this.value); gatherChangedParameter(this.form)">
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_log_data_enabled</td>
		</tr>

		<tr class="classvisibility_log_data_enabled">
			<td class="indent2">
				<span>Data Files Retention</span>
			</td>
			<td>
				<form id="log_data_datafilesretention_form">
					<input required type="number" min="0" value="30"
						name="log.data.datafilesretention" id="log_data_datafilesretention_value"
						onchange="(!validity.rangeUnderflow||(value=0));gatherChangedParameter(this.form, true)">Days
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_log_data_datafilesretention</td>
		</tr>
	</table>


	<!-- Network -->
	<table class="table">
		<colgroup>
			<col span="1" style="width:310px">
			<col span="1" style="width:310px;">
			<col span="1">
		</colgroup>
		<tr>
			<th colspan="3">Network</th>
		</tr>

		<tr>
			<td style="padding-top:25px">
				<b>WLAN Configuration</b>
			</td>
			<td colspan="2" style="padding-top:25px">
				<span style="font-weight:bold;color:red;display:none;"
					id="wlan_reboot_note">Reboot required to apply changes!</span>
			</td>
		</tr>
<!--- //@TODO FEATURE. Not yet implemented
		<tr class="expert">
			<td class="indent1">
				<span>Operation Mode</span>
			</td>
			<td>
				<form id="network_wlan_opmode_enabled_form">
					<select class="classvisibility_init" name="network.wlan.opmode" id="network_wlan_opmode_value"
							onchange="gatherChangedParameter(this.form)">
						<option value="-1">Off</option>
						<option value="0" selected>On, Station Full</option>
						<option value="1">On, Station Limited</option>
						<option value="2">On, AP Full</option>
						<option value="3">On, AP Limited</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_network_wlan_opmode</td>
		</tr>
-->
		<tr>
			<td class="indent1">
				<span>SSID</span>
			</td>
			<td>
				<form id="network_wlan_ssid_form">
					<input required type="text" name="network.wlan.ssid" id="network_wlan_ssid_value" placeholder="SSID Name Access Point"
						onchange="$('#wlan_reboot_note').show();gatherChangedParameter(this.form)">
						<!--<span toggle="#network_wlan_ssid_value" class="fa fa-fw fa-search field-icon"></span> //@TODO FEATURE. Not yet implemented -->
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_network_wlan_ssid</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Password</span>
			</td>
			<td>
				<form class="wrapper" id="network_wlan_password_form">
					<input type="password" name="network.wlan.password" id="network_wlan_password_value" autocomplete="on"
						onchange="$('#wlan_reboot_note').show();gatherChangedParameter(this.form)">
						<span toggle="#network_wlan_password_value" class="fa fa-fw fa-eye field-icon toggle-password"></span>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_network_wlan_password</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Hostname</span>
			</td>
			<td>
				<form id="network_wlan_hostname_form">
					<input required type="text" name="network.hostname" id="network_wlan_hostname_value" placeholder="watermeter"
						onchange="$('#wlan_reboot_note').show();gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_network_wlan_hostname</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Network Configuration</span>
			</td>
			<td>
				<form id="network_wlan_ipv4_networkconfig_form">
					<select class="classvisibility_init" name="network.wlan.ipv4.networkconfig" id="network_wlan_ipv4_networkconfig_value"
							onchange="setClassVisibility('classvisibility_network_wlan_ipv4_networkconfig', this.value == 1);
								$('#wlan_reboot_note').show();gatherChangedParameter(this.form, true)">
						<option value="0" selected>DHCP</option>
						<option value="1">Static</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_network_wlan_ipv4_networkconfig</td>
		</tr>

		<tr class="classvisibility_network_wlan_ipv4_networkconfig">
			<td class="indent2">
				<span>IP Address</span>
			</td>
			<td>
				<form id="network_wlan_ipv4_ipaddress_form">
					<input required type="text" ip-mask name="network.wlan.ipv4.ipaddress" id="network_wlan_ipv4_ipaddress_value"
						placeholder="192.168.xxx.xxx" onchange="$('#wlan_reboot_note').show();gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_network_wlan_ipv4_ipaddress</td>
		</tr>

		<tr class="classvisibility_network_wlan_ipv4_networkconfig">
			<td class="indent2">
				<span>Subnet Mask</span>
			</td>
			<td>
				<form id="network_wlan_ipv4_subnetmask_form">
					<input required type="text" ip-mask name="network.wlan.ipv4.subnetmask" id="network_wlan_ipv4_subnetmask_value"
						placeholder="255.255.255.0" onchange="$('#wlan_reboot_note').show();gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_network_wlan_ipv4_subnetmask</td>
		</tr>

		<tr class="classvisibility_network_wlan_ipv4_networkconfig">
			<td class="indent2">
				<span>Gateway Address</span>
			</td>
			<td>
				<form id="network_wlan_ipv4_gatewayaddress_form">
					<input required type="text" ip-mask name="network.wlan.ipv4.gatewayaddress" id="network_wlan_ipv4_gatewayaddress_value"
						placeholder="192.168.xxx.xxx" onchange="$('#wlan_reboot_note').show();gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_network_wlan_ipv4_gatewayaddress</td>
		</tr>

		<tr class="classvisibility_network_wlan_ipv4_networkconfig">
			<td class="indent2">
				<span>DNS Server</span>
			</td>
			<td>
				<form id="network_wlan_ipv4_dnsserver_form">
					<input type="text" ip-mask name="network.wlan.ipv4.dnsserver" id="network_wlan_ipv4_dnsserver_value"
						placeholder="192.168.xxx.xxx" onchange="$('#wlan_reboot_note').show();gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_network_wlan_ipv4_dnsserver</td>
		</tr>

		<tr class="expert">
			<td class="indent1">
				<span>Roaming</span>
			</td>
			<td>
				<form id="network_wlan_wlanroaming_enabled_form">
					<select class="classvisibility_init" name="network.wlan.wlanroaming.enabled" id="network_wlan_wlanroaming_enabled_value"
							onchange="setClassVisibility('classvisibility_network_wlan_wlanroaming_enabled', this.value); gatherChangedParameter(this.form)">
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_network_wlan_wlanroaming_enabled</td>
		</tr>

		<tr class="classvisibility_network_wlan_wlanroaming_enabled expert">
			<td class="indent2">
				<span>RSSI Threshold</span>
			</td>
			<td>
				<form id="network_wlan_wlanroaming_rssithreshold_form">
					<input required type="number" min="-100" max="0" value="-75"
						name="network.wlan.wlanroaming.rssithreshold" id="network_wlan_wlanroaming_rssithreshold_value"
						onchange="(!validity.rangeUnderflow||(value=-100)) && (!validity.rangeOverflow||(value=0));
							gatherChangedParameter(this.form, true)">dBm
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_network_wlan_wlanroaming_rssithreshold</td>
		</tr>

		<tr>
			<td style="padding-top:25px" colspan="3">
				<b>Time Configuration</b>
			</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Time Zone</span>
				<p></p><p></p>
			</td>
			<td>
				<form id="network_time_timezone_form">
					<input required type="text" name="network.time.timezone" id="network_time_timezone_value"
						placeholder="CET-1CEST,M3.5.0,M10.5.0/3" onchange="gatherChangedParameter(this.form)">
				</form>
				<p>Use <a href="timezones.html" target="_blank">timezones</a> to find your settings</p>
			</td>
			<td style="visibility:hidden">$TOOLTIP_network_time_timezone</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Time Synchronization</span>
			</td>
			<td>
				<form id="network_time_ntp_timesyncenabled_form">
					<select class="classvisibility_init" name="network.time.ntp.timesyncenabled" id="network_time_ntp_timesyncenabled_value"
							onchange="setClassVisibility('classvisibility_network_time_ntp_timesyncenabled', this.value);
										gatherChangedParameter(this.form)">
						<option value="false">Disabled</option>
						<option value="true" selected>Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_network_time_ntp_timesyncenabled</td>
		</tr>

		<tr class="classvisibility_network_time_ntp_timesyncenabled">
			<td class="indent2">
				<span>Time Server (NTP)</span>
			</td>
			<td>
				<form id="network_time_ntp_timeserver_form">
					<input type="text" name="network.time.ntp.timeserver" id="network_time_ntp_timeserver_value"
						placeholder="pool.ntp.org" onchange="gatherChangedParameter(this.form)">
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_network_time_ntp_timeserver</td>
		</tr>

		<tr class="classvisibility_network_time_ntp_timesyncenabled expert">
			<td class="indent2">
				<span>Process Start Interlock</span>
			</td>
			<td>
				<form id="network_time_ntp_processstartinterlock_form">
					<select name="network.time.ntp.processstartinterlock" id="network_time_ntp_processstartinterlock_value"
							onchange="gatherChangedParameter(this.form)">
						<option value="false">Disabled</option>
						<option value="true" selected>Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_network_time_ntp_processstartinterlock</td>
		</tr>
	</table>


	<!-- System -->
	<table class="table">
		<colgroup>
			<col span="1" style="width:310px">
			<col span="1" style="width:310px;">
			<col span="1">
		</colgroup>
		<tr>
			<th colspan="3">System</th>
		</tr>

		<tr class="expert">
			<td class="indent1">
				<span>CPU Frequency</span>
			</td>
			<td>
				<form id="system_cpufrequency_form">
					<select name="system.cpufrequency" id="system_cpufrequency_value"
							onchange="gatherChangedParameter(this.form, true)">
						<option value="160" selected>160 MHz</option>
						<option value="240">240 MHz</option>
					</select>
			</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_system_cpufrequency</td>
		</tr>
	</table>


	<!-- WebUI -->
	<table class="table">
		<colgroup>
			<col span="1" style="width:310px">
			<col span="1" style="width:310px;">
			<col span="1">
		</colgroup>
		<tr>
			<th colspan="3">WebUI</th>
		</tr>

		<tr>
			<td style="padding-top:25px" colspan="3">
				<b>Overview</b>
			</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Page Auto Refresh</span>
			</td>
			<td>
				<form id="webui_autorefresh_overviewpage_enabled_form">
					<select class="classvisibility_init"
							name="webui.autorefresh.overviewpage.enabled" id="webui_autorefresh_overviewpage_enabled_value"
							onchange="setClassVisibility('classvisibility_webui_autorefresh_overviewpage_enabled', this.value);
								gatherChangedParameter(this.form)">
						<option value="false">Disabled</option>
						<option value="true" selected>Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_webui_autorefresh_overviewpage_enabled</td>
		</tr>

		<tr class="classvisibility_webui_autorefresh_overviewpage_enabled">
			<td class="indent2">
				<span>Refresh Time</span>
			</td>
			<td>
				<form id="webui_autorefresh_overviewpage_refreshtime_form">
					<input required type="number" min="1" value="5"
						name="webui.autorefresh.overviewpage.refreshtime" id="webui_autorefresh_overviewpage_refreshtime_value"
						onchange="(!validity.rangeUnderflow||(value=1));gatherChangedParameter(this.form, true)">Seconds
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_webui_autorefresh_overviewpage_refreshtime</td>
		</tr>

		<tr>
			<td style="padding-top:25px" colspan="3">
				<b>Data Graph</b>
			</td>
		</tr>

		<tr>
			<td class="indent1">
				<span>Page Auto Refresh</span>
			</td>
			<td>
				<form id="webui_autorefresh_datagraphpage_enabled_form">
					<select class="classvisibility_init"
							name="webui.autorefresh.datagraphpage.enabled" id="webui_autorefresh_datagraphpage_enabled_value"
							onchange="setClassVisibility('classvisibility_webui_autorefresh_datagraphpage_enabled', this.value);
								gatherChangedParameter(this.form)">
						<option value="false" selected>Disabled</option>
						<option value="true">Enabled</option>
					</select>
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_webui_autorefresh_datagraphpage_enabled</td>
		</tr>

		<tr class="classvisibility_webui_autorefresh_datagraphpage_enabled">
			<td class="indent2">
				<span>Refresh Time</span>
			</td>
			<td>
				<form id="webui_autorefresh_datagraphpage_refreshtime_form">
					<input required type="number" min="1" value="60"
						name="webui.autorefresh.datagraphpage.refreshtime" id="webui_autorefresh_datagraphpage_refreshtime_value"
						onchange="(!validity.rangeUnderflow||(value=1));gatherChangedParameter(this.form, true)">Seconds
				</form>
			</td>
			<td style="visibility:hidden">$TOOLTIP_webui_autorefresh_datagraphpage_refreshtime</td>
		</tr>
	</table>

	<table style="padding-top:10px">
		<tr>
			<td>
				<button class="button" id="button_saveConfig" onclick="saveConfigData()">Save And Apply</button>
			</td>
		</tr>
	</table>
</div>


<script src="global_common.js?v=$COMMIT_HASH"></script>
<script src="global_data.js?v=$COMMIT_HASH"></script>
<script src="mask.ip-input.js?v=$COMMIT_HASH"></script>
<script>
	// Enable IP input validation
	$(document).ready(function()
	{
		$('[ip-mask]').ipAddress();
	});


	// Toggle password view
	$(".toggle-password").click(function()
	{
		//$(this).toggleClass("fa-eye fa-eye-slash"); // No symbol toggle
		let input = $($(this).attr("toggle"));

		if (input.attr("type") == "password") {
			input.attr("type", "text");
		}
		else {
			input.attr("type", "password");
		}
	});

	function initGpioSection()
	{
		getGpioPins();
	}


	function getGpioPins()
	{
		let gpioPinSelection = $("[id$='gpionumber_value']").find("option").remove().end();

		let firstEnabledPinFound = false;
		let idx = 0;
		for (let i = 0; i < jsonConfig.gpio.gpiopin.length; ++i) {
			gpioPinSelection.append(new Option("GPIO" + jsonConfig.gpio.gpiopin[i].gpionumber,
				jsonConfig.gpio.gpiopin[i].gpionumber));

			if (!firstEnabledPinFound && jsonConfig.gpio.gpiopin[i].pinenabled) {
				firstEnabledPinFound = true;
				idx = i;
			}
		}

		gpioPinSelection.prop('selectedIndex', idx);
		gpioPinSelectAfterChange(true);
		getGpioPinUsage(parseInt(gpioPinSelection[0].value));
	}


	function getGpioPinUsage(gpioNumberSelected)
	{
		let gpioPinModeSel = document.querySelector("[id$='pinmode_value']");

		// Check all pins to find selected pin
		for (let i = 0; i < jsonConfig.gpio.gpiopin.length; i++) {
			if (jsonConfig.gpio.gpiopin[i].gpionumber == gpioNumberSelected) {
				if (jsonConfig.gpio.gpiopin[i].gpiousage.substring(0,10) == "flashlight") { // Special case: Default flashlight GPIO
					// Show option "flashlight-default"
					gpioPinModeSel.options[0].removeAttribute("hidden");
				}
				else {
					// Hide option "flashlight-default"
					gpioPinModeSel.options[0].setAttribute('hidden', 'true');
				}

				// Show expert view / text for restricted pins
				if (jsonConfig.gpio.gpiopin[i].gpiousage.substring(0,10) == "restricted") {
					$(".classexpert_gpio").each(function() {$(this).addClass("expert")});
					$("#gpio_gpiopin_pinmode_restrictedusagetext")
					.text("[Default: " + jsonConfig.gpio.gpiopin[i].gpiousage.substring(12).replace(/\-/g, " ") + "]")
					.show();
				}
				else {
					$(".classexpert_gpio").each(function() {$(this).removeClass("expert")});
					$("#gpio_gpiopin_pinmode_restrictedusagetext").hide();
				}

				break;
			}
		}
	}


	function gpioPinModeChanged()
	{
		let pwm = false;
		let smartled = false;
		for (let i = 0 ; i < jsonConfig.gpio.gpiopin.length; ++i) {
			if (jsonConfig.gpio.gpiopin[i].gpiousage == "flashlight-pwm")
				pwm = true;
			if (jsonConfig.gpio.gpiopin[i].gpiousage == "flashlight-smartled")
				smartled = true;

			if (document.getElementById("gpio_customizationenabled_value").value == 'true') {
				document.getElementById("takeimage_flashlightgpiomapping_value").innerText = "Customized [GPIO Section]";
			}
			else {
				if (jsonConfig.gpio.gpiopin[i].gpiousage.substring(0,10) == "flashlight") {
					document.getElementById("takeimage_flashlightgpiomapping_value").innerText =
						"Default [GPIO" + jsonConfig.gpio.gpiopin[i].gpionumber + "]";
				}
			}
		}

		// Pin disabled, stopp here (code above needed to show flashlight mapping indicator)
		if (document.querySelectorAll('[id$="pinenabled_value"]')[0].value == 'false')
			return;

		let elPinMode = document.querySelectorAll('[id$="pinmode_value"]')[0];
		let elPinCaptureMode = document.querySelectorAll('[id$="capturemode_value"]')[0];

		if ((pwm && elPinMode.value == "flashlight-default") ||
			elPinMode.value == "flashlight-pwm" ||
			elPinMode.value == "output-pwm"
		)
			setClassVisibility("gpio_show_pwm_frequency", true);
		else
			setClassVisibility("gpio_show_pwm_frequency", false);

		if (elPinMode.value == "input" ||
			elPinMode.value == "input-pullup" ||
			elPinMode.value == "input-pulldown")
		{
			setClassVisibility("gpio_show_capture_mode", true);

			if (elPinCaptureMode.value != "cyclic-polling")
				setClassVisibility("gpio_show_debounce_time", true);
			else
				setClassVisibility("gpio_show_debounce_time", false);
		}
		else {
			setClassVisibility("gpio_show_capture_mode", false);
			setClassVisibility("gpio_show_debounce_time", false);
		}

		if (elPinMode.value  == "flashlight-smartled" ||
			(smartled && elPinMode.value == "flashlight-default")
		)
			setClassVisibility("gpio_show_smartled", true);
		else
			setClassVisibility("gpio_show_smartled", false);


		if (elPinMode.value .substring(0,10) == "flashlight" &&
			elPinMode.value  != "flashlight-digital"
		)
			setClassVisibility("gpio_show_intersity_correction", true);
		else
			setClassVisibility("gpio_show_intersity_correction", false);
	}


	function gpioPinSelectAfterChange(init = false)
	{
		let gpioPinSelect = $("[id$='gpionumber_value']")[0];

		// Rename elements to match new selection
		$(".form_gpio_config").children().each(function() {
			this.name = this.name.split(".gpiopin.")[0] + ".gpiopin." +
				(gpioPinSelect.selectedIndex).toString() + "." + this.name.split(".gpiopin.")[1].substring(2);
				this.id = this.name.replace(/\./g, '_') + "_value";
		});

		// Reload content
		let jsonConfigModified = deepMergeObjects(jsonConfig, jsonConfigModifiedDelta);
		let jsonConfigModifiedKeyified = jsonObjectKeyify(jsonConfigModified)
		parseCurrentParametrization(jsonConfigModifiedKeyified);
		if(!init) {
			$("[id$='pinenabled_value']")[0].onchange(); // Eval pin enabled state
			getGpioPinUsage(gpioPinSelect.value);
		}
	}


	function sequenceSelectAfterChange(classEl, selectEl)
	{
		// Rename elements to match new selection
		let idx = $("#" + selectEl).prop("selectedIndex").toString();
		$("." + classEl).children().each(function() {
			this.name = this.name.split(".sequence.")[0] + ".sequence." +
			idx + "." + this.name.split(/[.]+/).pop();
			this.id = this.name.replace(/\./g, '_') + "_value";
		});

		// Reload content
		let jsonConfigModified = deepMergeObjects(jsonConfig, jsonConfigModifiedDelta);
		let jsonConfigModifiedKeyified = jsonObjectKeyify(jsonConfigModified)
		parseCurrentParametrization(jsonConfigModifiedKeyified);
	}


	function fillSequenceSelectionOptions()
	{
		$("[id$='sequencename_value']").each(function() {
			$(this).find('option').remove().end();

			for (let i = 0; i < jsonConfig.numbersequences.sequence.length; ++i)
				$(this).append(new Option(jsonConfig.numbersequences.sequence[i].sequencename,
					jsonConfig.numbersequences.sequence[i].sequencename));
		});
	}


	function fillModelSelectionOptions(modelFileListObj)
	{
		let digitModelSelection = $("#digit_model_value").find("option").remove().end();
		let analogModelSelection = $("#analog_model_value").find("option").remove().end();

		let modelFileArray = modelFileListObj.files.sort(); // Convert to array and sort

		for (let i = 0; i < modelFileArray.length; ++i) {
			if (modelFileArray[i].startsWith("dig")) { // Digit model, only show in the digit selection
				digitModelSelection.append(new Option(modelFileArray[i].substring(0, modelFileArray[i].lastIndexOf('.')), modelFileArray[i]));
			}
			else if (modelFileArray[i].startsWith("ana")) { // Analog model, only show in the analog selection
				analogModelSelection.append(new Option(modelFileArray[i].substring(0, modelFileArray[i].lastIndexOf('.')), modelFileArray[i]));
			}
			else { // Unknown, show in both selections
				digitModelSelection.append(new Option(modelFileArray[i].substring(0, modelFileArray[i].lastIndexOf('.')), modelFileArray[i]));
				analogModelSelection.append(new Option(modelFileArray[i].substring(0, modelFileArray[i].lastIndexOf('.')), modelFileArray[i]));
			}
		}
	}


	function fillCertSelectionOptions(certFileListObj)
	{
		let cacertSelection = $("select[name$=cacert]").find("option").remove().end();
		let clientcertSelection = $("select[name$=clientcert]").find("option").remove().end();
		let clientkeySelection = $("select[name$=clientkey]").find("option").remove().end();

		let certFileArray = certFileListObj.files.sort(); // Convert to array and sort

		// Add empty selection
		cacertSelection.append(new Option("None", ""));
		clientcertSelection.append(new Option("None", ""));
		clientkeySelection.append(new Option("None", ""));

		for (let i = 0; i < certFileArray.length; ++i) {
			cacertSelection.append(new Option(certFileArray[i], certFileArray[i]));
			clientcertSelection.append(new Option(certFileArray[i], certFileArray[i]));
			clientkeySelection.append(new Option(certFileArray[i], certFileArray[i]));
		}
	}


	function saveConfigData()
	{
		if (confirm("Are you sure you want to save and apply the new configuration?")) {
			firework.launch('Save and apply configuration...', 'success', 2000, true);

			saveConfig(JSON.stringify(jsonConfigModifiedDelta)).then(() => {
				setTimeout(function() {
					reloadConfig();
					setTimeout(function() {
						init();
					}, 500);
				}, 500);
			});
		}
	}


	function loadConfigData(modelFileListObj, certFileListObj)
	{
		fillModelSelectionOptions(modelFileListObj);
		fillCertSelectionOptions(certFileListObj);

		let jsonConfigKeyified = [];            // Config: array as key-value pairs
		[jsonConfig, jsonConfigKeyified] = getConfigFromStorage(2); // Get config
		parseCurrentParametrization(jsonConfigKeyified);

		fillSequenceSelectionOptions();
		initGpioSection();

		triggerClassElementOnChange("classvisibility_init");
		jsonConfigModifiedDelta = {}; // Reset modified parameter container after subparameter visibilty is set

		$("#wlan_reboot_note").hide(); // Hide reboot note
		$("#divloading").hide(); // Hide loading indicator
		$("#divcontent").show(); // Show parameter content
	}


	// hash #description open the details part of the page
	function openDescription()
	{
		if(window.location.hash) {
			let hash = window.location.hash.substring(1); //Puts hash in variable, and removes the # character
			if(hash == 'description')
				document.getElementById("desc_details").open = true;
		}
	}


	async function init()
	{
		openDescription();

		// Ensure tflite file list, cert file list and config is loaded before parsing data
		Promise.all([getTfliteFileList(), getCertFileList(), loadConfig(2)])
			.then(([modelFileListObj, certFileListObj]) => loadConfigData(modelFileListObj, certFileListObj))
			.catch((error) => {
				firework.launch('Failed loading data for configuration page. Please repeat or check logs', 'danger', 30000);
				console.error("Failed loading data for configuration page. Error: " + error.message);
			});

	}


	init();

</script>

</body>
</html>
